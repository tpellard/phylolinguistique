<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Phylolinguistique avec R - 4&nbsp; Évaluation des résultats</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./bibliographie.html" rel="next">
<link href="./parcimonie.html" rel="prev">
<link href="./phyloling_circ.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer"
  }
}</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta property="og:title" content="Phylolinguistique avec R - 4&nbsp; Évaluation des résultats">
<meta property="og:description" content="">
<meta property="og:image" content="https://tpellard.github.io/phylolinguistique/evaluation_files/figure-html/unnamed-chunk-4-1.png">
<meta property="og:site-name" content="Phylolinguistique avec R">
<meta property="og:locale" content="fr-FR">
<meta property="og:image:height" content="3000">
<meta property="og:image:width" content="4200">
<meta name="twitter:title" content="Phylolinguistique avec R - 4&nbsp; Évaluation des résultats">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://tpellard.github.io/phylolinguistique/evaluation_files/figure-html/unnamed-chunk-4-1.png">
<meta name="twitter:creator" content="@ThomasPellard">
<meta name="twitter:image-height" content="3000">
<meta name="twitter:image-width" content="4200">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./evaluation.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Évaluation des résultats</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Recherche" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./phyloling_scirc.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Phylolinguistique avec R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/tpellard/phylolinguistique" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Basculer le mode sombre"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bienvenue</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./avanttout.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Avant tout chose</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Préparation des données</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./distance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Méthodes par distance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./parcimonie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Méthodes de parcimonie</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evaluation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Évaluation des résultats</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bibliographie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliographie</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sur cette page</h2>
   
  <ul>
<li><a href="#%C3%A9valuation-de-la-stabilit%C3%A9-des-clades" id="toc-évaluation-de-la-stabilité-des-clades" class="nav-link active" data-scroll-target="#%C3%A9valuation-de-la-stabilit%C3%A9-des-clades"><span class="header-section-number">4.1</span> Évaluation de la stabilité des clades</a></li>
  <li><a href="#r%C3%A9sumer-laccord-entre-des-r%C3%A9sultats" id="toc-résumer-laccord-entre-des-résultats" class="nav-link" data-scroll-target="#r%C3%A9sumer-laccord-entre-des-r%C3%A9sultats"><span class="header-section-number">4.2</span> Résumer l’accord entre des résultats</a></li>
  <li><a href="#mesures-dhomoplasie-et-de-coh%C3%A9rence" id="toc-mesures-dhomoplasie-et-de-cohérence" class="nav-link" data-scroll-target="#mesures-dhomoplasie-et-de-coh%C3%A9rence"><span class="header-section-number">4.3</span> Mesures d’homoplasie et de cohérence</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/tpellard/phylolinguistique/issues/new" class="toc-action">Signaler un problème</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Évaluation des résultats</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="évaluation-de-la-stabilité-des-clades" class="level2 page-columns page-full" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="évaluation-de-la-stabilité-des-clades">
<span class="header-section-number">4.1</span> Évaluation de la stabilité des clades</h2>
<p>Il est utile d’évaluer la stabilité des clades obtenus. On peut le faire avec un ré-échantillonnage aléatoire avec remise (<a href="https://fr.wikipedia.org/wiki/Bootstrap_(statistiques)"><em>bootstrap</em></a>) qui va simuler de la variation et permettre ainsi de quantifier la sensibilité des résultats aux données de l’échantillon observé. Cette méthode permet d’obtenir pour chaque branche de l’arbre la proportion d’arbres ré-échantillonnés qui contiennent cette branche et ainsi d’identifier les branches reposant sur un faible nombre de données.</p>
<p>On peut par exemple évaluer nos <a href="./distance.html#sec-upgma">résultats obtenus par UPGMA</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/KlausVigo/phangorn">phangorn</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ms609.github.io/TreeTools/">TreeTools</a></span><span class="op">)</span></span>
<span><span class="va">lx_phy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ms609.github.io/TreeTools/reference/ReadCharacters.html">ReadAsPhyDat</a></span><span class="op">(</span><span class="st">"lx_phy_multi.nex"</span><span class="op">)</span></span>
<span><span class="va">lx_upgma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span><span class="op">(</span><span class="st">"lx_upgma.tree"</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il faut au préalable récupérer la matrice de données. C’est totalement redondant mais il s’agit d’une contrainte technique. Il faut en plus définir une fonction qui sera appliquée à chaque échantillon, ici on utilise la composition de <code>MatrixTophyDat()</code>, <code><a href="https://ms609.github.io/TreeTools/reference/Hamming.html">Hamming()</a></code> puis <code><a href="https://klausvigo.github.io/phangorn/reference/upgma.html">upgma()</a></code>. On définit également à l’avance le nombre de ré-échantillonnages à effectuer, ici 1000.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lx_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ms609.github.io/TreeTools/reference/MatrixToPhyDat.html">PhyDatToMatrix</a></span><span class="op">(</span><span class="va">lx_phy</span><span class="op">)</span></span>
<span><span class="va">boot_upgma_hamming</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/upgma.html">upgma</a></span><span class="op">(</span><span class="fu"><a href="https://ms609.github.io/TreeTools/reference/Hamming.html">Hamming</a></span><span class="op">(</span><span class="fu"><a href="https://ms609.github.io/TreeTools/reference/MatrixToPhyDat.html">MatrixToPhyDat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">n_bs</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On peut alors lancer la procédure de ré-échantillonnage sur l’arbre obtenu par UPGMA et la matrice de données. Même avec 1000 ré-échantillonnages, on obtient les résultats en un temps très court.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>La fonction <code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code> permet de fixer la <a href="https://fr.wikipedia.org/wiki/Graine_al%C3%A9atoire">graine aléatoire</a> et d’assurer la reproductibilité des résultats.</p>
</div></div><div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123456</span><span class="op">)</span></span>
<span><span class="va">lx_upgma_bs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/boot.phylo.html">boot.phylo</a></span><span class="op">(</span><span class="va">lx_upgma</span>,</span>
<span>  <span class="va">lx_m</span>,</span>
<span>  <span class="va">boot_upgma_hamming</span>,</span>
<span>  B <span class="op">=</span> <span class="va">n_bs</span>,</span>
<span>  trees <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On peut ainsi obtenir le nombre de ré-échantillonnages où chacun des clades de l’arbre par UPGMA apparaît, les transformer en proportions, et affecter ces valeurs aux nœuds internes de l’arbre. On peut alors les afficher sur le dendrogramme.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">upgma_bs_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/boot.phylo.html">prop.clades</a></span><span class="op">(</span><span class="va">lx_upgma</span>, <span class="va">lx_upgma_bs</span><span class="op">$</span><span class="va">trees</span>, rooted <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">upgma_support_pct</span> <span class="op">&lt;-</span> <span class="va">upgma_bs_scores</span> <span class="op">/</span> <span class="va">n_bs</span></span>
<span><span class="va">lx_upgma</span><span class="op">$</span><span class="va">node.label</span> <span class="op">&lt;-</span> <span class="va">upgma_support_pct</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lx_upgma</span>, show.node.label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="evaluation_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
<p>Une autre méthodes consiste à directement afficher les résultats avec <code><a href="https://klausvigo.github.io/phangorn/reference/plotBS.html">plotBS()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/plotBS.html">plotBS</a></span><span class="op">(</span><span class="va">lx_upgma</span>, <span class="va">lx_upgma_bs</span><span class="op">$</span><span class="va">trees</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="evaluation_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
<p>On peut choisir de n’afficher que les valeurs supérieures à un certain seuil, typiquement 70%.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">upgma_support_pct</span><span class="op">[</span><span class="va">upgma_support_pct</span> <span class="op">&lt;</span> <span class="fl">.7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">lx_upgma</span><span class="op">$</span><span class="va">node.label</span> <span class="op">&lt;-</span> <span class="va">upgma_support_pct</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lx_upgma</span>, show.node.label <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="evaluation_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
<p>Ou plus simplement avec <code><a href="https://klausvigo.github.io/phangorn/reference/plotBS.html">plotBS()</a></code>:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/plotBS.html">plotBS</a></span><span class="op">(</span><span class="va">lx_upgma</span>, <span class="va">lx_upgma_bs</span><span class="op">$</span><span class="va">trees</span>, p <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="evaluation_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
<p>Un <a href="./parcimonie.html">arbre parcimonieux</a> obtenu avec <code><a href="https://klausvigo.github.io/phangorn/reference/parsimony.html">pratchet()</a></code> contient déjà des valeurs de <em>bootstrap</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lx_pratchet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html">read_rds</a></span><span class="op">(</span><span class="st">"lx_pratchet.rds"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/plotBS.html">plotBS</a></span><span class="op">(</span><span class="va">lx_pratchet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, p <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="evaluation_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section><section id="résumer-laccord-entre-des-résultats" class="level2 page-columns page-full" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="résumer-laccord-entre-des-résultats">
<span class="header-section-number">4.2</span> Résumer l’accord entre des résultats</h2>
<p>Une analyse phylogénétique résulte souvent non pas en un arbre unique mais en un ensemble d’arbres. C’est le cas avec les résultats de notre <a href="./parcimonie.html">analyse de parcimonie</a>.</p>
<!-- trees <- map(1:3, ~ rtree(n = 9)) -->
<!-- trees <- as.multiPhylo(c(trees[1], trees[1], trees[1], trees, trees)) -->
<p>Il est possible de résumer l’accord entre ces arbres par un arbre consensus qui ne contient que les clades présents dans une proportion <em>p</em> des arbres. Un arbre consensus est donc normalement moins résolu que les arbres obtenus.</p>
<p>Un arbre consensus strict ne contient que les clades présents dans <em>tous</em> les arbres (<em>p</em> = 1), ce qui peut parfois aboutir à un «râteau» sans aucun clade à l’intérieur de l’arbre.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Un arbre consensus n’a pas en principe de longueurs de branches.</p>
</div></div><div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lx_pratchet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span><span class="op">(</span><span class="st">"lx_pratchet.tree"</span><span class="op">)</span></span>
<span><span class="va">lx_sc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/consensus.html">consensus</a></span><span class="op">(</span><span class="va">lx_pratchet</span>, p <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lx_sc</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="evaluation_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
<p>Un arbre consensus majoritaire contient lui les clades présents dans la majorité (<em>p</em> ≥ .5) des arbres.</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lx_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/consensus.html">consensus</a></span><span class="op">(</span><span class="va">lx_pratchet</span>, p <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">lx_mc</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="evaluation_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
</section><section id="mesures-dhomoplasie-et-de-cohérence" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="mesures-dhomoplasie-et-de-cohérence">
<span class="header-section-number">4.3</span> Mesures d’homoplasie et de cohérence</h2>
<p>Il est possible de calculer l’indice de cohérence (<em>consistency index</em>, ci) d’un caractère avec un arbre. Un caractère est cohérent avec un arbre si cet arbre implique que le caractère a évolué avec le minimum de transformations possibles pour rendre compte de ces états. Ce minimum <em>m</em> est l’amplitude du caractère, et pour un caractère avec <em>k</em> états possible, il est égal à <span class="math inline">\(k - 1\)</span>. L’indice de cohérence se calcule comme le rapport de l’amplitude <em>m</em> sur le nombre de pas (transformations) <em>s</em> observé pour ce caractère.</p>
<p><span class="math inline">\(ci = \frac{m}{s}\)</span></p>
<p>La fonction <code><a href="https://klausvigo.github.io/phangorn/reference/CI.html">CI()</a></code> avec l’option <code>sitewise</code> permet d’obtenir l’index de cohérence de chaque caractère d’une matrice phylogénétique. On obtient une valeur <code>NaN</code> quand il y a une division par 0, dans les cas de caractères sans transformation qui présentent le même état dans tous les taxons.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/CI.html">CI</a></span><span class="op">(</span><span class="va">lx_pratchet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">lx_phy</span>, sitewise <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ci</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1.0000000       NaN 1.0000000 0.6666667       NaN       NaN       NaN
  [8]       NaN       NaN       NaN 1.0000000 0.7500000       NaN 1.0000000
 [15] 1.0000000 0.6666667       NaN       NaN       NaN       NaN 1.0000000
 [22]       NaN       NaN       NaN       NaN       NaN       NaN       NaN
 [29]       NaN       NaN       NaN       NaN       NaN 0.5000000 1.0000000
 [36] 1.0000000       NaN       NaN       NaN       NaN       NaN       NaN
 [43]       NaN       NaN 1.0000000       NaN 1.0000000       NaN       NaN
 [50]       NaN 1.0000000       NaN       NaN       NaN 0.3333333 0.5000000
 [57]       NaN 1.0000000       NaN 1.0000000 0.8000000 1.0000000 1.0000000
 [64]       NaN 1.0000000 1.0000000       NaN 0.5000000 1.0000000       NaN
 [71] 1.0000000 0.5000000       NaN       NaN       NaN 0.7500000       NaN
 [78]       NaN 1.0000000       NaN       NaN       NaN 1.0000000 1.0000000
 [85] 0.7500000 0.7500000       NaN       NaN       NaN       NaN       NaN
 [92] 0.7500000       NaN       NaN       NaN 1.0000000       NaN 0.5000000
 [99]       NaN       NaN       NaN 1.0000000       NaN       NaN       NaN
[106]       NaN       NaN       NaN       NaN 1.0000000</code></pre>
</div>
</div>
<p>Le nombre d’homoplasies <em>h</em> pour un caractère s’obtient par <span class="math inline">\(h = l - r\)</span>. La valeur de <em>r</em> se calcule avec une fonction cachée de <code>phangorn</code>, et celle de <em>l</em> avec la fonction <code><a href="https://klausvigo.github.io/phangorn/reference/parsimony.html">sankoff()</a></code> et l’option <code>site = "site"</code>. En raison de la manière dont sont traités en interne les caractères de la matrice phylogénétique, il faut jouer avec les index de l’objet <code>PhyDat</code> pour bien récupérer la liste complète des valeurs.</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">phangorn</span><span class="fu">:::</span><span class="fu">lowerBound</span><span class="op">(</span><span class="va">lx_phy</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">lx_phy</span>, <span class="st">"index"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/parsimony.html">sankoff</a></span><span class="op">(</span><span class="va">lx_pratchet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">lx_phy</span>, site <span class="op">=</span> <span class="st">"site"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">lx_phy</span>, <span class="st">"index"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">h</span> <span class="op">&lt;-</span> <span class="va">s</span> <span class="op">-</span> <span class="va">m</span></span>
<span><span class="va">h</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0
 [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 1 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 1 0 0
 [75] 0 1 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 1 0 0 0 0 0 2 0 0 0 0 0 0 0 0 0 0 0 0</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">h</span><span class="op">)</span></span>
<span><span class="va">H</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16</code></pre>
</div>
</div>
<p>On peut alors obtenir le numéro des caractères présentant de l’homoplasie:</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">h</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  4 12 16 34 55 56 61 68 72 76 85 86 92 98</code></pre>
</div>
</div>
<p>L’indice de cohérence CI de l’ensemble des caractères est lui le rapport de la somme <em>M</em> des <em>m</em> sur la somme <em>S</em> des <em>s</em> de tous les <em>N</em> caractères.</p>
<p><span class="math display">\[CI = \frac{M}{S}, M = \sum^N_{i=1} m_i, S = \sum^N_{i=1} s_i\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/CI.html">CI</a></span><span class="op">(</span><span class="va">lx_pratchet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">lx_phy</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8431373</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8431373</code></pre>
</div>
</div>
<p><em>S</em> est le nombre total de pas ou longueur de l’arbre. On peut l’obtenir avec la fonction <code><a href="https://klausvigo.github.io/phangorn/reference/parsimony.html">sankoff()</a></code> sans option.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 102</code></pre>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/parsimony.html">sankoff</a></span><span class="op">(</span><span class="va">lx_pratchet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">lx_phy</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 102</code></pre>
</div>
</div>
<p>Cet indice de cohérence est une mesure du degré d’homoplasie des données sur un arbre. Plus le score est bas, plus l’arbre contient d’homoplasie, et une valeur de 1 indique une absence totale d’homoplasie. Les caractères autapomorphiques ont un ci de 1.</p>
<p>L’indice de cohérence est cependant problématique car sa valeur minimale n’est en fait pas 0, ce qui ne permet donc pas de l’utiliser pour évaluer correctement le degré d’homoplasie.</p>
<p>Il est possible d’utiliser à la place un indice de cohérence mis à l’échelle (<em>rescaled consistency index</em>, rci) par l’introduction de <em>g</em>, le nombre maximal de transformations pour un caractère, ce qui correspond cas où toutes les transformations auraient lieu sur les branches terminales:</p>
<p><span class="math display">\[rci = \frac{g-s}{g-m}\frac{m}{s} = \frac{g-s}{g-m}ci\]</span></p>
<p>Les valeurs de <em>g</em> s’obtient avec une autre fonction cachée de <code>phangorn</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu">phangorn</span><span class="fu">:::</span><span class="fu">upperBound</span><span class="op">(</span><span class="va">lx_phy</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">lx_phy</span>, <span class="st">"index"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">g</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 6 0 1 3 0 0 0 0 0 0 1 5 0 6 1 4 0 0 0 0 3 0 0 0 0 0 0 0 0 0 0 0 0 3 4 1 0
 [38] 0 0 0 0 0 0 0 2 0 6 0 0 0 1 0 0 0 4 2 0 4 0 5 6 4 1 0 4 1 0 2 1 0 4 4 0 0
 [75] 0 5 0 0 3 0 0 0 7 4 6 5 0 0 0 0 0 6 0 0 0 2 0 4 0 0 0 1 0 0 0 0 0 0 0 3</code></pre>
</div>
</div>
<p>Mais il est plus simple de calculer la partie gauche de la formule du rci avec la fonction <code><a href="https://klausvigo.github.io/phangorn/reference/CI.html">RI()</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/CI.html">RI</a></span><span class="op">(</span><span class="va">lx_pratchet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">lx_phy</span>, sitewise <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/CI.html">CI</a></span><span class="op">(</span><span class="va">lx_pratchet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">lx_phy</span>, sitewise <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">rci</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1.0000000       NaN       NaN 0.0000000       NaN       NaN       NaN
  [8]       NaN       NaN       NaN       NaN 0.3750000       NaN 1.0000000
 [15]       NaN 0.3333333       NaN       NaN       NaN       NaN       NaN
 [22]       NaN       NaN       NaN       NaN       NaN       NaN       NaN
 [29]       NaN       NaN       NaN       NaN       NaN 0.2500000 1.0000000
 [36]       NaN       NaN       NaN       NaN       NaN       NaN       NaN
 [43]       NaN       NaN 1.0000000       NaN 1.0000000       NaN       NaN
 [50]       NaN       NaN       NaN       NaN       NaN 0.1111111 0.0000000
 [57]       NaN 1.0000000       NaN 1.0000000 0.4000000 1.0000000       NaN
 [64]       NaN 1.0000000       NaN       NaN 0.0000000       NaN       NaN
 [71] 1.0000000 0.3333333       NaN       NaN       NaN 0.3750000       NaN
 [78]       NaN 1.0000000       NaN       NaN       NaN 1.0000000 1.0000000
 [85] 0.5000000 0.3750000       NaN       NaN       NaN       NaN       NaN
 [92] 0.5000000       NaN       NaN       NaN       NaN       NaN 0.0000000
 [99]       NaN       NaN       NaN       NaN       NaN       NaN       NaN
[106]       NaN       NaN       NaN       NaN       NaN</code></pre>
</div>
</div>
<p>L’indice de cohérence mis à l’échelle RCI pour l’ensemble des caractères se calcule comme suit:</p>
<p><span class="math display">\[RCI = \frac{G-S}{G-M}\frac{M}{S}, G = \sum^N_{i=1} g_i\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/CI.html">CI</a></span><span class="op">(</span><span class="va">lx_pratchet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">lx_phy</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/CI.html">RI</a></span><span class="op">(</span><span class="va">lx_pratchet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">lx_phy</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5678271</code></pre>
</div>
</div>
<p>Le coefficient de distortion <em>d</em> d’un caractère est le nombre d’homoplasies observées par rapport au nombre maximal possible.</p>
<p><span class="math display">\[d = \frac{h}{g - m}\]</span></p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">h</span><span class="op">/</span><span class="op">(</span><span class="va">g</span> <span class="op">-</span> <span class="va">m</span><span class="op">)</span></span>
<span><span class="va">d</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0.0000000       NaN       NaN 1.0000000       NaN       NaN       NaN
  [8]       NaN       NaN       NaN       NaN 0.5000000       NaN 0.0000000
 [15]       NaN 0.5000000       NaN       NaN       NaN       NaN       NaN
 [22]       NaN       NaN       NaN       NaN       NaN       NaN       NaN
 [29]       NaN       NaN       NaN       NaN       NaN 0.5000000 0.0000000
 [36]       NaN       NaN       NaN       NaN       NaN       NaN       NaN
 [43]       NaN       NaN 0.0000000       NaN 0.0000000       NaN       NaN
 [50]       NaN       NaN       NaN       NaN       NaN 0.6666667 1.0000000
 [57]       NaN 0.0000000       NaN 0.0000000 0.5000000 0.0000000       NaN
 [64]       NaN 0.0000000       NaN       NaN 1.0000000       NaN       NaN
 [71] 0.0000000 0.3333333       NaN       NaN       NaN 0.5000000       NaN
 [78]       NaN 0.0000000       NaN       NaN       NaN 0.0000000 0.0000000
 [85] 0.3333333 0.5000000       NaN       NaN       NaN       NaN       NaN
 [92] 0.3333333       NaN       NaN       NaN       NaN       NaN 1.0000000
 [99]       NaN       NaN       NaN       NaN       NaN       NaN       NaN
[106]       NaN       NaN       NaN       NaN       NaN</code></pre>
</div>
</div>
<p>On peut aussi le calculer pour un ensemble de caractères.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">h</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">D</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3265306</code></pre>
</div>
</div>
<p>La partie gauche des formules d’indice de cohérence est lui-même une mesure appelée indice de rétention (<em>retention index</em>, ri, RI). Il s’agit du complément <span class="math inline">\(1 - D\)</span> de l’indice de distorsion <em>D</em>. Il mesure la proportion d’homoplasies possibles mais non observées, ce qui revient à la proportion de synapomorphies possibles effectivement retenues comme telle sur un arbre. Les caractères autapomorphiques ont un ri de 0.</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ri</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/CI.html">RI</a></span><span class="op">(</span><span class="va">lx_pratchet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">lx_phy</span>, sitewise <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ri</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1.0000000       NaN       NaN 0.0000000       NaN       NaN       NaN
  [8]       NaN       NaN       NaN       NaN 0.5000000       NaN 1.0000000
 [15]       NaN 0.5000000       NaN       NaN       NaN       NaN       NaN
 [22]       NaN       NaN       NaN       NaN       NaN       NaN       NaN
 [29]       NaN       NaN       NaN       NaN       NaN 0.5000000 1.0000000
 [36]       NaN       NaN       NaN       NaN       NaN       NaN       NaN
 [43]       NaN       NaN 1.0000000       NaN 1.0000000       NaN       NaN
 [50]       NaN       NaN       NaN       NaN       NaN 0.3333333 0.0000000
 [57]       NaN 1.0000000       NaN 1.0000000 0.5000000 1.0000000       NaN
 [64]       NaN 1.0000000       NaN       NaN 0.0000000       NaN       NaN
 [71] 1.0000000 0.6666667       NaN       NaN       NaN 0.5000000       NaN
 [78]       NaN 1.0000000       NaN       NaN       NaN 1.0000000 1.0000000
 [85] 0.6666667 0.5000000       NaN       NaN       NaN       NaN       NaN
 [92] 0.6666667       NaN       NaN       NaN       NaN       NaN 0.0000000
 [99]       NaN       NaN       NaN       NaN       NaN       NaN       NaN
[106]       NaN       NaN       NaN       NaN       NaN</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">RI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/CI.html">RI</a></span><span class="op">(</span><span class="va">lx_pratchet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">lx_phy</span><span class="op">)</span></span>
<span><span class="va">RI</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6734694</code></pre>
</div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">1</span> <span class="op">-</span> <span class="va">D</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6734694</code></pre>
</div>
</div>
<p>Il est ainsi possible de comparer les scores de différents arbres, par exemple ceux obtenus par parcimonie et celui obtenu par UPGMA.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">lx_pratchet</span>, <span class="va">lx_sc</span>, <span class="va">lx_mc</span>, <span class="va">lx_upgma</span><span class="op">)</span></span>
<span><span class="va">nms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="st">"Strict"</span>, <span class="st">"Majority"</span>, <span class="st">"UPGMA"</span><span class="op">)</span></span>
<span><span class="va">comp_tb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">tr</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">m_x</span> <span class="op">&lt;-</span> <span class="fu">phangorn</span><span class="fu">:::</span><span class="fu">lowerBound</span><span class="op">(</span><span class="va">lx_phy</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">lx_phy</span>, <span class="st">"index"</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">s_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/parsimony.html">sankoff</a></span><span class="op">(</span><span class="va">tr</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">lx_phy</span>, site <span class="op">=</span> <span class="st">"site"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">lx_phy</span>, <span class="st">"index"</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">h_x</span> <span class="op">&lt;-</span> <span class="va">s_x</span> <span class="op">-</span> <span class="va">m_x</span></span>
<span>  <span class="va">CI_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/CI.html">CI</a></span><span class="op">(</span><span class="va">tr</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">lx_phy</span><span class="op">)</span></span>
<span>  <span class="va">RI_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://klausvigo.github.io/phangorn/reference/CI.html">RI</a></span><span class="op">(</span><span class="va">tr</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">lx_phy</span><span class="op">)</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span><span class="va">var</span>, <span class="op">~</span><span class="va">value</span>,</span>
<span>  <span class="st">"S"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">s_x</span><span class="op">)</span>,</span>
<span>  <span class="st">"H"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">h_x</span><span class="op">)</span>,</span>
<span>  <span class="st">"CI"</span>, <span class="va">CI_x</span>,</span>
<span>  <span class="st">"RCI"</span>, <span class="va">CI_x</span> <span class="op">*</span> <span class="va">RI_x</span>,</span>
<span>  <span class="st">"RI"</span>, <span class="va">RI_x</span>,</span>
<span>  <span class="st">"D"</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">RI_x</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">nms</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">df</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html">reduce</a></span><span class="op">(</span><span class="va">left_join</span><span class="op">)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["var"],"name":[1],"type":["chr"],"align":["left"]},{"label":["1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["3"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["4"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Strict"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Majority"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["UPGMA"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"S","2":"102.00","3":"102.00","4":"102.00","5":"100.00","6":"103.00","7":"102.00","8":"102.00"},{"1":"H","2":"16.00","3":"16.00","4":"16.00","5":"14.00","6":"17.00","7":"16.00","8":"16.00"},{"1":"CI","2":"0.84","3":"0.84","4":"0.84","5":"0.86","6":"0.83","7":"0.84","8":"0.84"},{"1":"RCI","2":"0.57","3":"0.57","4":"0.57","5":"0.61","6":"0.55","7":"0.57","8":"0.57"},{"1":"RI","2":"0.67","3":"0.67","4":"0.67","5":"0.71","6":"0.65","7":"0.67","8":"0.67"},{"1":"D","2":"0.33","3":"0.33","4":"0.33","5":"0.29","6":"0.35","7":"0.33","8":"0.33"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Les résultats sont similaires, mais le 4<sup>e</sup> arbre obtenu par parcimonie contient moins d’homoplasies et a des meilleurs scores de CI, RCI et RI. On remarque donc que l’option <code>all = TRUE</code> de <code><a href="https://klausvigo.github.io/phangorn/reference/parsimony.html">pratchet()</a></code> donne un ensemble d’arbres qui ne sont pas tous aussi parcimonieux les uns que les autres.</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./parcimonie.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Méthodes de parcimonie</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./bibliographie.html" class="pagination-link">
        <span class="nav-page-text">Bibliographie</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
 [Thomas Pellard]
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>